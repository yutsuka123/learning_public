<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TypeScript ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ‡ãƒ¢</title>
    <meta name="description" content="ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªTypeScripté–‹ç™ºã®å®Ÿè·µä¾‹ - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³">
    <style>
        /* åˆæœŸãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }
        
        .loading-subtitle {
            font-size: 1rem;
            opacity: 0.8;
        }
        
        /* ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .error-container {
            max-width: 600px;
            margin: 2rem auto;
            padding: 2rem;
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .error-container h2 {
            margin-top: 0;
            color: #721c24;
        }
        
        .error-container pre {
            background: #ffffff;
            padding: 1rem;
            border-radius: 4px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <!-- åˆæœŸãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ -->
    <div id="loading" class="loading-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">TypeScript ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èª­ã¿è¾¼ã¿ä¸­...</div>
        <div class="loading-subtitle">ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªé–‹ç™ºç’°å¢ƒã‚’æº–å‚™ã—ã¦ã„ã¾ã™</div>
    </div>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ï¼ˆJavaScriptã§å‹•çš„ã«ç”Ÿæˆï¼‰ -->
    <div id="main-content" style="display: none;"></div>

    <!-- ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
    <div id="error-container" style="display: none;"></div>

    <script type="module">
        /**
         * ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
         * 
         * ğŸ¯ ç›®çš„:
         * - TypeScriptãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å‹•çš„èª­ã¿è¾¼ã¿
         * - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
         * - ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
         * 
         * ğŸ’¡ å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ:
         * - ES Modulesã‚’ä½¿ç”¨ã—ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿
         * - éåŒæœŸå‡¦ç†ã®é©åˆ‡ãªç®¡ç†
         * - ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ã‚’è€ƒæ…®ã—ãŸãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
         */
        
        // DOMè¦ç´ ã®å–å¾—
        const loadingElement = document.getElementById('loading');
        const mainContentElement = document.getElementById('main-content');
        const errorContainerElement = document.getElementById('error-container');

        /**
         * ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºé–¢æ•°
         * @param {string} title - ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒˆãƒ«
         * @param {string} message - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
         * @param {Error} [error] - ã‚¨ãƒ©ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
         */
        function displayError(title, message, error = null) {
            console.error(`${title}: ${message}`, error);
            
            const errorHtml = `
                <div class="error-container">
                    <h2>${title}</h2>
                    <p>${message}</p>
                    ${error ? `
                        <details>
                            <summary>è©³ç´°ãªã‚¨ãƒ©ãƒ¼æƒ…å ±</summary>
                            <pre>${error.stack || error.message || error}</pre>
                        </details>
                    ` : ''}
                    <p>
                        <strong>å¯¾å‡¦æ³•:</strong><br>
                        1. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼è©³ç´°ã‚’ç¢ºèªã—ã¦ãã ã•ã„<br>
                        2. TypeScriptãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ãã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„<br>
                        3. ã™ã¹ã¦ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„
                    </p>
                </div>
            `;
            
            errorContainerElement.innerHTML = errorHtml;
            errorContainerElement.style.display = 'block';
            loadingElement.style.display = 'none';
        }

        /**
         * ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–
         */
        async function initializeApplication() {
            try {
                console.log('=== TypeScript ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ é–‹å§‹ ===');
                
                // åŸºæœ¬å‹ã‚·ã‚¹ãƒ†ãƒ ç·´ç¿’ã®å®Ÿè¡Œ
                console.log('åŸºæœ¬å‹ã‚·ã‚¹ãƒ†ãƒ ç·´ç¿’ã‚’èª­ã¿è¾¼ã¿ä¸­...');
                
                // åŸºæœ¬ç·´ç¿’ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¨å®Ÿè¡Œ
                // æ³¨æ„: ã“ã®éƒ¨åˆ†ã¯å®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆã«åˆã‚ã›ã¦èª¿æ•´ãŒå¿…è¦
                try {
                    // åŸºæœ¬å‹ã‚·ã‚¹ãƒ†ãƒ ç·´ç¿’ã®å®Ÿè¡Œ
                    await import('./01_basic_types_practice.js');
                    console.log('âœ… åŸºæœ¬å‹ã‚·ã‚¹ãƒ†ãƒ ç·´ç¿’ãŒå®Œäº†ã—ã¾ã—ãŸ');
                } catch (importError) {
                    console.warn('åŸºæœ¬å‹ã‚·ã‚¹ãƒ†ãƒ ç·´ç¿’ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸãŒã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¶šè¡Œã—ã¾ã™:', importError.message);
                }

                // ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–
                console.log('ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ–ä¸­...');
                
                // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒ†ãƒŠã®ä½œæˆ
                const appContainer = document.createElement('div');
                appContainer.id = 'app-container';
                appContainer.className = 'typescript-frontend-app';
                mainContentElement.appendChild(appContainer);

                // ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
                const { FrontendApp } = await import('./modules/FrontendApp.js');
                
                // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
                const appConfig = {
                    containerSelector: '#app-container',
                    apiEndpoint: '/api/users',
                    enableDebugMode: true,
                    animationDuration: 300
                };

                // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–
                const app = new FrontendApp(appConfig);
                await app.initialize();

                // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ã‚’éè¡¨ç¤ºã«ã—ã€ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º
                loadingElement.style.display = 'none';
                mainContentElement.style.display = 'block';

                console.log('âœ… ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ­£å¸¸ã«èµ·å‹•ã—ã¾ã—ãŸï¼');
                console.log('ğŸ“± ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒåˆ©ç”¨å¯èƒ½ã§ã™');

                // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®å‡ºåŠ›
                if (appConfig.enableDebugMode) {
                    console.log('ğŸ” ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ã§ã™');
                    console.log('ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹:', app.getState());
                    
                    // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚³ãƒ¼ãƒ—ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å…¬é–‹ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
                    window.typescriptApp = app;
                    console.log('ğŸ’¡ window.typescriptApp ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™');
                }

            } catch (error) {
                displayError(
                    'ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼',
                    'TypeScriptã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚',
                    error
                );
            }
        }

        /**
         * ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†å¾Œã®å‡¦ç†
         */
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOMèª­ã¿è¾¼ã¿å®Œäº† - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–ã‚’é–‹å§‹ã—ã¾ã™');
            initializeApplication();
        });

        /**
         * æœªå‡¦ç†ã®ã‚¨ãƒ©ãƒ¼ã‚’ã‚­ãƒ£ãƒƒãƒ
         */
        window.addEventListener('error', (event) => {
            console.error('æœªå‡¦ç†ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', event.error);
            displayError(
                'äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼',
                'ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œä¸­ã«äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚',
                event.error
            );
        });

        /**
         * æœªå‡¦ç†ã®Promiseæ‹’å¦ã‚’ã‚­ãƒ£ãƒƒãƒ
         */
        window.addEventListener('unhandledrejection', (event) => {
            console.error('æœªå‡¦ç†ã®Promiseæ‹’å¦:', event.reason);
            displayError(
                'Promiseæ‹’å¦ã‚¨ãƒ©ãƒ¼',
                'éåŒæœŸå‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚',
                event.reason
            );
        });

        // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
        if (window.performance && window.performance.mark) {
            window.performance.mark('typescript-app-start');
            
            window.addEventListener('load', () => {
                window.performance.mark('typescript-app-loaded');
                
                try {
                    window.performance.measure(
                        'typescript-app-load-time',
                        'typescript-app-start',
                        'typescript-app-loaded'
                    );
                    
                    const measure = window.performance.getEntriesByName('typescript-app-load-time')[0];
                    console.log(`âš¡ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èª­ã¿è¾¼ã¿æ™‚é–“: ${Math.round(measure.duration)}ms`);
                } catch (perfError) {
                    console.log('ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šã«å¤±æ•—ã—ã¾ã—ãŸ:', perfError);
                }
            });
        }
    </script>
</body>
</html>
