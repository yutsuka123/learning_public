; ==============================================================================
; IoT ESP32-S3 / PlatformIO 設定
; ==============================================================================
; [重要]
; - 本設定は IoT 第3段階（MQTT TLS + ID/パスワード認証）を前提にする。
; - パーティションは実機COM9から取得したCSVを使用し、実機構成を再現する。
;
; [厳守]
; - 対象ボードは ESP32-S3 固定。
; - 依存バージョンは固定し、再現性を確保する。
; - 認証実値（証明書、鍵、パスワード）をこのファイルへ記載しない。
;
; [推奨]
; - C++実装では可能な範囲で C++20 を利用する。
; ==============================================================================

[platformio]
default_envs = esp32s3_secure

[env]
platform = espressif32@6.12.0
framework = espidf
monitor_speed = 115200
monitor_filters = time

[env:esp32s3_secure]
board = esp32-s3-devkitc-1
; [推奨] COM番号固定を避けるため upload_port は未指定（自動検出）
; 必要時のみ `pio run -t upload --upload-port COMx` で明示指定する

; [厳守] 実機読出しパーティションを使用
board_build.partitions = partitions/esp32s3_from_device_16MB.csv

; [推奨] C++20を有効化（IDF依存により将来調整の可能性あり）
build_flags =
  -std=gnu++2a
  -D APP_TARGET_ESP32S3=1
  -D MQTT_TLS_REQUIRED=1
  -D MQTT_AUTH_REQUIRED=1

; 第3段階の作業で必要になりやすいターゲット
targets =
  build
  upload
