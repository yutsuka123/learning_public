# IoT 問題点記録書

[重要] 本書は開発時に発生した問題と原因・対策を追跡管理する。  
理由: 同一障害の再発防止と、切り分け時間の短縮のため。

## 記録 #0001
- 見出し: ESP32からMQTT(1883)へ到達できない
- 種類: コマンド
- 分野: サーバー
- 状態: 解決済
- 試験番号: 7001
- 日時: 2026-03-02

### 症状
- ESP32 側ログで `WiFiClient connect timeout 3000 ms` が継続し、`kMqttInitDone` を受信できない。

### 原因
- ブローカPCのWi-Fiネットワークプロファイルが `Public` だったが、FWルール `mqtt` は `Private` のみ適用だった。
- その結果、同一LAN内のESP32から `172.16.1.59:1883` への受信許可が適用されなかった。

### 対策
- ブローカPCのFW適用プロファイルを実ネットワーク条件に合わせる（Public/Private整合）。
- 必要に応じて MQTT受信ルールを Public へも適用。
- 接続検証時にネットワークプロファイル種別を初期確認項目へ追加。

### 再発防止
- [厳守] `運用記録_ESP32_MQTT接続検証_2026-03-02.md` の「重要な注意点」を接続試験前チェックとして運用する。
- [推奨] 将来は IoT専用LAN を `Private` とし、ルールをサブネット限定する。

## 変更履歴
- 2026-03-02: 新規作成。MQTT到達失敗（FW Profile不一致）の原因と対策を記録。
